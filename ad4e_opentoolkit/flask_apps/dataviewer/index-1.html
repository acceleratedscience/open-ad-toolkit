<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<link rel="stylesheet" href="../_css/carbon.css" />
		<link rel="stylesheet" href="../_css/main.css" />
		<link href="dataviewer.css" rel="stylesheet" />
		<link href="tabulator/css/tabulator_simple.min.css" rel="stylesheet" />
		<link href="tabulator_ibm_theme.css" rel="stylesheet" />
		<script type="text/javascript" src="tabulator/js/tabulator.min.js"></script>
		<script type="text/javascript" src="table.js"></script>
		<style></style>
	</head>
	<body>
		<h1>Table Viewer</h1>
		<p class="soft">Some subtitle here</p>
		<p>This is FPO proof-of-concept UI. Will become a spreadsheet-like interface to view/edit data.</p>
		<p id="edit-mode" style="color: #d00; display: none">EDIT MODE ACTIVE</p>
		<br />

		<button id="btn-edit">Edit</button>

		<div id="table-wrap">
			<div id="table" data="{{data}}" headers="{{headers}}"></div>
			<a href="#">Reset columns</a>
		</div>

		<!-- <pre>{{headers}}</pre> -->
		<!-- <pre>{{data}}</pre> -->

		<script>
			// Activate edit mode.
			if (window.location.hash == '#edit') {
				document.getElementById('edit-mode').style.display = 'block'
				history.pushState('', document.title, window.location.pathname + window.location.search) // Remove hash
			}

			let data = [
				{ id: 1, name: 'Billy Bob', progress: '12', gender: 'male', height: 1, col: 'red', dob: '', driver: 1, color: 'red' },
				{ id: 2, name: 'Mary May', progress: '1', gender: 'female', height: 2, col: 'blue', dob: '14/05/1982', driver: true, color: 'green' },
				{ id: 3, name: 'Christine Lobowski', progress: '42', height: 0, col: 'green', dob: '22/05/1982', driver: 'true', color: 'yellow' },
				{ id: 4, name: 'Brendon Philips', progress: '125', gender: 'male', height: 1, col: 'orange', dob: '01/08/1980', color: 'blue' },
				{ id: 5, name: 'Margret Marmajuke', progress: '16', gender: 'female', height: 5, col: 'yellow', dob: '31/01/1999', color: 'orange' },
			]
			// data = JSON.stringify(data)

			const table = new Table('#table', {
				// height: '700px',
				columns: [
					{ title: 'Name', field: 'name', sorter: 'string', width: 200 },
					{ title: 'Progress', field: 'progress', sorter: 'number', formatter: 'progress' },
					{ title: 'Gender', field: 'gender', sorter: 'string' },
					{ title: 'Rating', field: 'rating', formatter: 'star', hozAlign: 'center', width: 100 },
					{ title: 'Favourite Color', field: 'col', sorter: 'string' },
					{ title: 'Date Of Birth', field: 'dob', sorter: 'date', hozAlign: 'center' },
					{ title: 'Driver', field: 'car', hozAlign: 'center', formatter: 'tickCross', sorter: 'boolean' },
					{ title: 'Color', field: 'color', hozAlign: 'right', sorter: 'string' },
				],
				data: data,
				reactiveData: true,
			})

			document.querySelector('#table-wrap > a').addEventListener('click', function () {
				table.resetCols()
			})

			document.getElementById('btn-edit').addEventListener('click', function () {
				table.toggleEditMode()
			})
		</script>
	</body>
</html>
