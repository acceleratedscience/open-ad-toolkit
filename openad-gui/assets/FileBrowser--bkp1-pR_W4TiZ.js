import{d as $,C as P,A as j,j as k,c as B,D as q,E as z,o as t,a as i,z as n,F as m,r as f,G,t as _,e as C,g as S,f as D,H,I as T,x as M,y as R,_ as J}from"./index-p_WFAwHj.js";import g from"./SvgServe-AotVP2aT.js";const K=y=>(M("data-v-0910694d"),y=y(),R(),y),O={id:"col-wrap"},Q=["title","onClick"],U=["title","onClick"],X=["title","onClick"],Y=["data-type","data-ext","title","onClick","onDblclick"],Z=["data-type","data-ext","title","onClick","onDblclick"],ee={key:0,class:"empty"},te={key:0,class:"col-split"},ae={key:0,class:"column file-preview"},le=["title"],se={id:"file-preview"},ie={class:"soft"},ne=K(()=>n("br",null,null,-1)),oe=$({__name:"FileBrowser--bkp1",setup(y){const W=new P,A=j(),o=k(null),d=k(null),p=k(null),r=k(null),x=B(()=>r.value?r.value[r.value.length-1]:void 0),F=B(()=>r.value?r.value[r.value.length-2]:void 0);q(async()=>{o.value=o.value?o.value:[],w()});async function L(a=void 0,s,l){h(l-1),a&&a.currentTarget.classList.add("sel"),s.disp_size=H(s._meta.size),s.disp_time_created=T(s._meta.time_created),s.disp_time_edited=T(s._meta.time_edited),o.value&&o.value.splice(l),d.value=s}function I(){d.value=null}function b(a){A.push("/~/"+a.path)}async function w(a=void 0,s="",l=0){const c=a?a.currentTarget:null,e=await N(s);e&&(I(),o.value&&(o.value.splice(l),o.value[l]=e)),c&&(h(l-1),c.classList.add("sel"),await z(),h(-1));const v=x.value?x.value.clientWidth:0,u=F.value?F.value.clientWidth:0,V=p.value?p.value.scrollWidth-v-u:0;p.value&&(p.value.scrollLeft=V)}async function E(a){console.log("resetCol",r,x),o.value&&o.value.splice(a+1),await z(),h(-1)}function h(a){r.value&&(a=(a+r.value.length)%r.value.length,r.value[a].querySelectorAll(".dir, .file").forEach(s=>s.classList.remove("sel")))}async function N(a=""){const{status:s,data:l,statusText:c}=await W.get_workspace_files(a);if(s!==200){console.error(c);return}else return l}return(a,s)=>(t(),i("div",{id:"col-scroll-x",ref_key:"colScroll",ref:p},[n("div",O,[(t(!0),i(m,null,f(o.value,(l,c)=>(t(),i(m,{key:c},[n("div",{class:"column",ref_for:!0,ref_key:"columns",ref:r},[n("div",{class:G(["col-header",{root:c==0}]),title:l._meta.name,onClick:e=>E(c)},_(l._meta.name),11,Q),(t(!0),i(m,null,f(l.dirs_hidden,(e,v)=>(t(),i("div",{key:v,class:"dir hidden",title:e.filename,onClick:u=>w(u,e.path,c+1)},[n("div",null,_(e.filename),1),(t(),C(g,{filename:"icn-caret-right",key:e.filename}))],8,U))),128)),(t(!0),i(m,null,f(l.dirs,(e,v)=>(t(),i("div",{key:v,class:"dir",title:e.filename,onClick:u=>w(u,e.path,c+1)},[n("div",null,_(e.filename),1),(t(),C(g,{filename:"icn-caret-right",key:e.filename}))],8,X))),128)),(t(!0),i(m,null,f(l.files_hidden,(e,v)=>(t(),i("div",{key:v,class:"file hidden","data-type":e._meta.type,"data-ext":e._meta.ext,title:e.filename,onClick:u=>L(u,e,c+1),onDblclick:u=>b(e)},[(t(),C(g,{filename:"icn-"+e._meta.type,key:e._meta.type},null,8,["filename"])),n("div",null,_(e.filename),1)],40,Y))),128)),(t(!0),i(m,null,f(l.files,(e,v)=>(t(),i("div",{key:v,class:"file","data-type":e._meta.type,"data-ext":e._meta.ext,title:e.filename,onClick:u=>L(u,e,c+1),onDblclick:u=>b(e)},[(t(),C(g,{filename:"icn-"+e._meta.type,key:e._meta.type},null,8,["filename"])),n("div",null,_(e.filename),1)],40,Z))),128)),l._meta.empty?(t(),i("div",ee,"Empty directory")):S("",!0)],512),o.value&&c<o.value.length-1||d.value?(t(),i("div",te)):S("",!0)],64))),128)),d.value?(t(),i("div",ae,[n("div",{class:"col-header",title:d.value._meta.name},_(d.value._meta.name),9,le),n("div",se,[n("b",null,_(d.value._meta.name),1),n("small",null,[n("i",null,_(d.value.disp_size),1),n("div",ie,[D(" Created: "+_(d.value.disp_time_created),1),ne,D(" Last edit: "+_(d.value.disp_time_edited),1)])])])])):S("",!0)])],512))}}),ue=J(oe,[["__scopeId","data-v-0910694d"]]);export{ue as default};
