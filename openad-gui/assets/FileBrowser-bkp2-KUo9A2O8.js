import{d as P,A as j,i as q,j as k,c as A,D as G,E as D,o as a,a as o,z as t,F as m,r as f,G as H,t as v,e as C,g as w,f as T,H as M,I as W,x as R,y as J,_ as K}from"./index-p_WFAwHj.js";import g from"./SvgServe-AotVP2aT.js";const b=h=>(R("data-v-8fe1fd68"),h=h(),J(),h),O={id:"col-wrap"},Q=b(()=>t("div",{class:"column filler-left"},[t("div",{class:"col-header"}),t("div",{class:"col-body"})],-1)),U=["title","onClick"],X={class:"col-body"},Y=["title","onClick"],Z=["title","onClick"],ee=["data-type","data-ext","title","onClick","onDblclick"],te=["data-type","data-ext","title","onClick","onDblclick"],ae={key:0,class:"empty"},le={key:0,class:"col-split"},se={key:0,class:"column file-preview"},ie=["title"],oe={id:"file-preview"},ce={class:"soft"},ne=b(()=>t("br",null,null,-1)),re=b(()=>t("div",{class:"column filler-right"},[t("div",{class:"col-header"}),t("div",{class:"col-body"})],-1)),ue=P({__name:"FileBrowser-bkp2",setup(h){const I=j(),L=q().loadApi("fileSystem"),c=k(null),d=k(null),p=k(null),r=k(null),x=A(()=>r.value?r.value[r.value.length-1]:void 0),F=A(()=>r.value?r.value[r.value.length-2]:void 0);G(async()=>{c.value=c.value?c.value:[],S()});async function B(l=void 0,i,s){y(s-1),l&&l.currentTarget.classList.add("sel"),i.disp_size=M(i._meta.size),i.disp_time_created=W(i._meta.time_created),i.disp_time_edited=W(i._meta.time_edited),c.value&&c.value.splice(s),d.value=i}function E(){d.value=null}function z(l){I.push("/~/"+l.path)}async function S(l=void 0,i="",s=0){const n=l?l.currentTarget:null,e=await V(i);e&&(E(),c.value&&(c.value.splice(s),c.value[s]=e)),n&&(y(s-1),n.classList.add("sel"),await D(),y(-1));const _=x.value?x.value.clientWidth:0,u=F.value?F.value.clientWidth:0,$=p.value?p.value.scrollWidth-_-u:0;p.value&&(p.value.scrollLeft=$)}async function N(l){console.log("resetCol",r,x),c.value&&c.value.splice(l+1),await D(),y(-1)}function y(l){r.value&&(l=(l+r.value.length)%r.value.length,r.value[l].querySelectorAll(".dir, .file").forEach(i=>i.classList.remove("sel")))}async function V(l=""){if(!L)return;const{status:i,data:s,statusText:n}=await L.get_workspace_files(l);if(i!==200){console.error(n);return}else return s}return(l,i)=>(a(),o("div",{id:"col-scroll-x",ref_key:"colScroll",ref:p},[t("div",O,[Q,(a(!0),o(m,null,f(c.value,(s,n)=>(a(),o(m,{key:n},[t("div",{class:"column",ref_for:!0,ref_key:"columns",ref:r},[t("div",{class:H(["col-header",{root:n==0}]),title:s._meta.name,onClick:e=>N(n)},v(s._meta.name),11,U),t("div",X,[(a(!0),o(m,null,f(s.dirs_hidden,(e,_)=>(a(),o("div",{key:_,class:"dir hidden",title:e.filename,onClick:u=>S(u,e.path,n+1)},[t("div",null,v(e.filename),1),(a(),C(g,{filename:"icn-caret-right",key:e.filename}))],8,Y))),128)),(a(!0),o(m,null,f(s.dirs,(e,_)=>(a(),o("div",{key:_,class:"dir",title:e.filename,onClick:u=>S(u,e.path,n+1)},[t("div",null,v(e.filename),1),(a(),C(g,{filename:"icn-caret-right",key:e.filename}))],8,Z))),128)),(a(!0),o(m,null,f(s.files_hidden,(e,_)=>(a(),o("div",{key:_,class:"file hidden","data-type":e._meta.type,"data-ext":e._meta.ext,title:e.filename,onClick:u=>B(u,e,n+1),onDblclick:u=>z(e)},[(a(),C(g,{filename:"icn-"+e._meta.type,key:e._meta.type},null,8,["filename"])),t("div",null,v(e.filename),1)],40,ee))),128)),(a(!0),o(m,null,f(s.files,(e,_)=>(a(),o("div",{key:_,class:"file","data-type":e._meta.type,"data-ext":e._meta.ext,title:e.filename,onClick:u=>B(u,e,n+1),onDblclick:u=>z(e)},[(a(),C(g,{filename:"icn-"+e._meta.type,key:e._meta.type},null,8,["filename"])),t("div",null,v(e.filename),1)],40,te))),128)),s._meta.empty?(a(),o("div",ae,"Empty directory")):w("",!0)])],512),c.value&&n<c.value.length-1||d.value?(a(),o("div",le)):w("",!0)],64))),128)),d.value?(a(),o("div",se,[t("div",{class:"col-header",title:d.value._meta.name},v(d.value._meta.name),9,ie),t("div",oe,[t("b",null,v(d.value._meta.name),1),t("small",null,[t("i",null,v(d.value.disp_size),1),t("div",ce,[T(" Created: "+v(d.value.disp_time_created),1),ne,T(" Last edit: "+v(d.value.disp_time_edited),1)])])])])):w("",!0),re])],512))}}),me=K(ue,[["__scopeId","data-v-8fe1fd68"]]);export{me as default};
