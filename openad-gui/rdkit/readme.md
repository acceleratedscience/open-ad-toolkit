See /src/utils/rdkit for implementation details.