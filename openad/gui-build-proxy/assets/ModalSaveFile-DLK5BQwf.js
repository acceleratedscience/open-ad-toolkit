import{d as R,z as h,R as H,r as b,c as x,I as W,g as T,h as s,k as r,p as t,q as u,v as c,t as v,j as w,n as p,i as f,F as y,B as C,m as B}from"./index-CoGQGb_u.js";import $ from"./FileBrowser-CVnhEAiB.js";const A={class:"flex-wrap-v"},G={class:"input-pad"},J={class:"file-ext"},Y=R({__name:"ModalSaveFile",emits:["mounted"],setup(K,{emit:D}){const n=h(),O=H(),I=D,g=b(!1),U=[{val:"smol.json",disp:"smol.json"},{val:"sdf",disp:"SDF"},{val:"csv",disp:"CSV"},{val:"mol",disp:"MOL"},{val:"smi",disp:"SMILES"}],E=[{val:"mmol.json",disp:"mmol.json"},{val:"cif",disp:"CIF"}],P=[{val:"mmol.json",disp:"mmol.json"},{val:"pdb",disp:"PDB"},{val:"cif",disp:"CIF"}],q=[{val:"molset.json",disp:"molset.json"},{val:"sdf",disp:"SDF"},{val:"csv",disp:"CSV"},{val:"smi",disp:"SMILES"}],a=b(null),j=b(null),F=b(null),o=x(()=>n.data??{}),m=x({get:()=>o.value.filename??"",set:d=>{F.value=null,n.setData({filename:d})}}),_=x({get:()=>o.value.path??"",set:d=>n.setData({path:d})}),M=x(()=>a.value||"");W(()=>{I("mounted"),o.value.dataType=="smol"?a.value="smol.json":["cif","pdb"].includes(o.value.dataType)?a.value="mmol.json":o.value.dataType=="molset"&&(a.value="molset.json"),setTimeout(()=>{var d;j.value=document.querySelector("#modal-save-file input.bx--text-input"),(d=j.value)==null||d.select()},350)});async function L(){var V;if(!m.value){F.value="Filename required.",(V=j.value)==null||V.focus();return}const l=(_.value?_.value+"/":"")+m.value+"."+M.value;n.onSubmit&&n.onSubmit({destinationPath:l,ext:M.value,srcDataType:o.value.dataType}),g.value=!0}async function N(){!g.value&&n.onCancel&&n.onCancel()}return(d,l)=>{const V=T("cv-text-input"),S=T("cv-dropdown-item"),k=T("cv-dropdown"),z=T("cv-modal");return s(),r(z,{id:"modal-save-file",visible:w(n).visible,size:"lg",onPrimaryClick:L,onModalHidden:N},{title:t(()=>[u("Save to "),c("b",null,v(w(O).workspace),1),u(" Workspace")]),content:t(()=>[c("div",A,[c("div",G,[p(V,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=e=>m.value=e),class:"ip-filename","hide-label":!0,"invalid-message":F.value},null,8,["modelValue","invalid-message"]),c("div",J,[c("span",null,v(m.value),1),u("."+v(M.value),1)]),o.value.exportOptions?(s(),f(y,{key:0},[o.value.dataType=="smol"?(s(),r(k,{key:0,modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value=e),class:"dd-output-options"},{default:t(()=>[(s(),f(y,null,C(U,(e,i)=>p(S,{key:i,value:e.val},{default:t(()=>[u(v(e.disp),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])):o.value.dataType=="cif"?(s(),r(k,{key:1,modelValue:a.value,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value=e),class:"dd-output-options"},{default:t(()=>[(s(),f(y,null,C(E,(e,i)=>p(S,{key:i,value:e.val},{default:t(()=>[u(v(e.disp),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])):o.value.dataType=="pdb"?(s(),r(k,{key:2,modelValue:a.value,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value=e),class:"dd-output-options"},{default:t(()=>[(s(),f(y,null,C(P,(e,i)=>p(S,{key:i,value:e.val},{default:t(()=>[u(v(e.disp),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])):o.value.dataType=="molset"?(s(),r(k,{key:3,modelValue:a.value,"onUpdate:modelValue":l[4]||(l[4]=e=>a.value=e),class:"dd-output-options"},{default:t(()=>[(s(),f(y,null,C(q,(e,i)=>p(S,{key:i,value:e.val},{default:t(()=>[u(v(e.disp),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])):B("",!0)],64)):B("",!0)]),p($,{isModal:!0,modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=e=>_.value=e)},null,8,["modelValue"])])]),"secondary-button":t(()=>[u("Cancel")]),"primary-button":t(()=>[u("Save")]),_:1},8,["visible"])}}});export{Y as default};
