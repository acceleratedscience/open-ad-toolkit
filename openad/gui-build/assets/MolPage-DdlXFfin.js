import{d as V,u as $,g as y,h as r,i as v,F as E,v as n,t as S,m as M,n as D,p as F,q as c,a as R,r as k,w as z,e as A,z as K,k as g,j as P,c as H,A as O,B as _,C as q,D as U,E as Y}from"./index-C4atIFxU.js";import{u as j}from"./MolViewerStore-CZsUqesa.js";import{_ as Q}from"./JsonViewer.vue_vue_type_script_setup_true_lang-B92t26TZ.js";import{M as W}from"./MolViewer-4PS9nGf1.js";import{B as G}from"./BaseFetchingFile-CHXxmAWT.js";import{i as X}from"./initRDKit-WaX80hiK.js";import"./BreadCrumbs-dB0kZmi3.js";import"./TextBox-DMhHDeKB.js";import"./BaseFetching-DmMYVmhf.js";import"./MolRender3D-D9ytaqP7.js";const J={class:"error-msg"},Z={class:"soft"},ee={key:1,class:"error-msg"},oe={key:2,class:"soft"},ne=n("br",null,null,-1),te=V({__name:"BaseError",props:{loadingError:{},errorText:{},backLink:{},note:{}},setup(p){const d=$(),e=p;function a(){e.backLink?d.push(e.backLink):d.back()}return(l,h)=>{const m=y("cv-button");return r(),v(E,null,[l.errorText?(r(),v(E,{key:0},[n("div",J,S(l.errorText),1),n("p",Z,S(l.loadingError),1)],64)):(r(),v("div",ee,S(l.loadingError),1)),l.note?(r(),v("p",oe,S(l.note),1)):M("",!0),ne,D(m,{onClick:a},{default:F(()=>[c("Back")]),_:1})],64)}}}),B="This may be a false negative. Please try again to confirm.",le=V({__name:"TheMolFromIdentifier",props:{identifier:{}},setup(p){const d=R(),e=j(),a=p,l=k(!1),h=k(!1),m=k(""),s=k(""),I=k(d.matched[0].name);a.identifier.startsWith("InChI=")?(e.setSmolIdentifier("inchi",a.identifier),e.fetchSmolVizData(a.identifier)):(w(a.identifier),e.fetchSmolVizData(a.identifier)),b(a.identifier),z(()=>a.identifier,t=>{e.clear(),t&&b(t)});async function b(t=null){t&&(l.value=!0,m.value="",s.value="",I.value=I.value.replace(/^headless-/,""),I.value=="mol"?(h.value=!0,C(t,{onSuccess:()=>{h.value=!1},onError:()=>{o(t,{onSuccess:()=>{h.value=!1},onError:()=>{h.value=!1,s.value=B}})}})):["smol","mol"].includes(I.value)?C(t,{onError:()=>{s.value=B}}):I.value=="mmol"&&o(t,{onError:()=>{s.value=B}}))}function C(t,{onSuccess:u=()=>{},onError:f=()=>{}}={}){A(K.getSmolData(t),{onSuccess:i=>{const T=!e.inchi;e.setMolData(i,"smol"),T&&e.fetchSmolVizData(t),u()},onError:f,loading:l,loadingError:m})}function o(t,{onSuccess:u=()=>{},onError:f=()=>{}}={}){A(K.getMmolData(t),{onSuccess:i=>{e.setMolData(i,"mmol"),u()},onError:f,loading:l,loadingError:m})}async function w(t){await X();let u=window.RDKit.get_mol(t);if(!u)return;const f=u.get_inchi();e.setSmolIdentifier("canonical_smiles",t),e.setSmolIdentifier("inchi",f),e.setSmolIdentifier("inchikey",window.RDKit.get_inchikey_for_inchi(f))}return(t,u)=>m.value?(r(),g(te,{key:0,loadingError:m.value,backLink:"/mol",note:s.value},null,8,["loadingError","note"])):l.value||h.value?(r(),g(G,{key:1})):P(d).query.use=="json"?(r(),g(Q,{key:2,data:P(e).smol},null,8,["data"])):(r(),g(W,{key:3,context:"identifier",loading:l.value,loadingError:m.value,onRetryLoad:u[0]||(u[0]=f=>b(t.identifier))},null,8,["loading","loadingError"]))}}),L=p=>(q("data-v-8beda03f"),p=p(),U(),p),ae=L(()=>n("h3",null,"Display any molecule",-1)),re=L(()=>n("br",null,null,-1)),ie=L(()=>n("br",null,null,-1)),se={key:0},ue={key:1},ce={key:0,class:"error-msg"},de={class:"fields"},me=V({__name:"TheMolInput",setup(p){const d=$(),e=k(""),a=k(""),l=k("smol"),h=[{label:"Small molecules",val:"smol"},{label:"Macromolecules",val:"mmol"}],m=H(()=>{switch(l.value){case"smol":return"InChI, SMILES, name, InChIKey or PubChem ID";case"mmol":return"FASTA sequence or PDB id";default:return"Molecule identifier"}});function s(C){const o={inchi:"InChI=1S/C10H14O/c1-7-5-9(11)6-8(2)10(7,3)4/h5-6H,1-4H3",smiles:"CC1=CC(=O)C=C(C1(C)C)C",name:"penguinone",inchikey:"RHIYIMQPIGYWEK-UHFFFAOYSA-N",cid:"681",fasta:"IINVKTSLKTIIKNALDKIQX",pdbId:"8t3n"};e.value=o[C],a.value=""}function I(){e.value="",a.value=""}function b(){e.value?d.push({name:l.value,params:{identifier:e.value.toString()}}):a.value="Please enter a molecule identifier."}return(C,o)=>{const w=y("cv-radio-button"),t=y("cv-radio-group"),u=y("cv-text-input"),f=y("cv-button");return r(),v(E,null,[ae,re,D(t,{legendText:"Search options",hideLegend:!0,onChange:I},{default:F(()=>[(r(),v(E,null,O(h,({label:i,val:T},N)=>D(w,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=x=>l.value=x),key:N,name:"group-1",label:i,value:T,"hide-label":!1,"label-left":!1},null,8,["modelValue","label","value"])),64))]),_:1}),ie,["mol","smol"].includes(l.value)?(r(),v("p",se,[c(" Accepted identifiers are: "),n("b",null,[n("a",{href:"#",onClick:o[1]||(o[1]=_(i=>s("inchi"),["prevent"]))},"InChI")]),c(" or "),n("b",null,[n("a",{href:"#",onClick:o[2]||(o[2]=_(i=>s("smiles"),["prevent"]))},"SMILES")]),c(" and "),n("b",null,[n("a",{href:"#",onClick:o[3]||(o[3]=_(i=>s("name"),["prevent"]))},"name")]),c(", "),n("b",null,[n("a",{href:"#",onClick:o[4]||(o[4]=_(i=>s("inchikey"),["prevent"]))},"InChIKey")]),c(" or "),n("b",null,[n("a",{href:"#",onClick:o[5]||(o[5]=_(i=>s("cid"),["prevent"]))},"PubChem CID")]),c(" when a molecule is listed on PubChem. ")])):M("",!0),["mol","mmol"].includes(l.value)?(r(),v("p",ue,[c(" Macromolecules can be found by their "),n("b",null,[n("a",{href:"#",onClick:o[6]||(o[6]=_(i=>s("fasta"),["prevent"]))},"FASTA sequence")]),c(" or "),n("b",null,[n("a",{href:"#",onClick:o[7]||(o[7]=_(i=>s("pdbId"),["prevent"]))},"PDB id")]),c(". ")])):M("",!0),n("form",{id:"input-form",onSubmit:_(b,["prevent"])},[a.value?(r(),v("div",ce,S(a.value),1)):M("",!0),n("div",de,[D(u,{modelValue:e.value,"onUpdate:modelValue":o[8]||(o[8]=i=>e.value=i),type:"text",placeholder:m.value,"hide-label":!0},null,8,["modelValue","placeholder"]),D(f,{size:"default"},{default:F(()=>[c("Display")]),_:1})])],32)],64)}}}),pe=Y(me,[["__scopeId","data-v-8beda03f"]]),Se=V({__name:"MolPage",props:{identifier:{}},setup(p){return(d,e)=>d.identifier?(r(),g(le,{key:0,identifier:d.identifier},null,8,["identifier"])):(r(),g(pe,{key:1}))}});export{Se as default};
