import{d as E,g as ve,h as e,i as t,k as M,p as ue,n as T,I as U,q as g,m as p,T as pt,S as O,C as ie,D as re,v as a,E as H,j as $,F as C,r as P,w as ct,Q as ne,Y as D,a1 as ft,A as F,t as y,P as yt,u as _e,L as fe,b as J,a2 as gt,c as k,a3 as G,H as ut,e as he,z as pe,a4 as kt,X as bt,R as dt,W as ye,B as wt,o as $t,a5 as St,a6 as Mt}from"./index-EqhxGKMg.js";import{u as R}from"./MolViewerStore-DZ8s2iYg.js";import{u as ce,B as j}from"./BaseFetching-CNiZnOhW.js";import{B as Ct}from"./BreadCrumbs-B2ceGopE.js";import{M as vt}from"./MolRender3D-Cup_GhAS.js";const Dt=h=>(ie("data-v-b1760b0b"),h=h(),re(),h),Bt=Dt(()=>a("div",{class:"filler"},null,-1)),It=E({__name:"BreadCrumbsNot",props:{backto:{},collapsed:{type:Boolean}},setup(h){return(u,i)=>{const o=ve("router-link");return e(),t("div",{id:"not-breadrumbs",class:O({collapsed:u.collapsed})},[u.backto?(e(),M(o,{key:0,to:u.backto,class:"backto"},{default:ue(()=>[T(U,{icon:"icn-arrow-left"}),g(" Back")]),_:1},8,["to"])):p("",!0),Bt,pt(u.$slots,"default",{},void 0,!0)],2)}}}),Vt=H(It,[["__scopeId","data-v-b1760b0b"]]),Tt=["innerHTML"],At=E({__name:"MolViewerVizSmol",setup(h){const u=R();return(i,o)=>(e(),t(C,null,[a("div",{class:"container-2d",innerHTML:$(u).svg},null,8,Tt),T(vt,{data3D:$(u).mdl,data3DFormat:"sdf",molName:$(u).name},null,8,["data3D","molName"])],64))}}),Ft=H(At,[["__scopeId","data-v-908ceb7a"]]),Et=E({__name:"MolViewerVizMmol",setup(h){const u=R();return(i,o)=>(e(),M(vt,{data3D:$(u).mmolData3D,data3DFormat:$(u).mmolData3DFormat,molName:$(u).name},null,8,["data3D","data3DFormat","molName"]))}}),Ht=H(Et,[["__scopeId","data-v-350c2e23"]]),Ot=h=>(ie("data-v-8cf19831"),h=h(),re(),h),Lt=Ot(()=>a("option",{value:"",disabled:"",hidden:""},null,-1)),Nt=["value"],xt=E({__name:"OverflowMenu",props:{options:{},disabled:{type:Boolean}},setup(h){const u=h,i=P("");return ct(()=>i.value,async o=>{if(o){const n=u.options.find(s=>s.val===o);if(n){const s=n.action;s()}}await yt(),i.value=""}),(o,n)=>(e(),t("div",{class:O(["btn-wrap",{disabled:o.disabled}])},[T(ne,{icon:"icn-overflow"}),D(a("select",{"onUpdate:modelValue":n[0]||(n[0]=s=>i.value=s)},[Lt,(e(!0),t(C,null,F(o.options,(s,_)=>(e(),t("option",{key:_,value:s.val},y(s.disp),9,Nt))),128))],512),[[ft,i.value]])],2))}}),zt=H(xt,[["__scopeId","data-v-8cf19831"]]);function _t(){const h=_e(),u=fe(),i=J(),o=ce(),n=R();return function(m,d=!1,c={}){const l=(i.moduleName=="MolViewer"?i.filenameNaked:c.defaultName)||"untitled";return u.display("ModalSaveFile",{path:i.pathDir,filename:l,dataType:m,exportOptions:d},{onSubmit:s})};async function s({destinationPath:_,ext:m,srcDataType:d},c=!1){try{d=="molset"?m=="molset.json"?await o.saveMolsetAsJSON(_,{newFile:!0,force:c}):m=="sdf"?await o.saveMolsetAsSDF(_,{newFile:!0,force:c}):m=="csv"?await o.saveMolsetAsCSV(_,{newFile:!0,force:c}):m=="smi"&&await o.saveMolsetAsSmiles(_,{newFile:!0,force:c}):d=="smol"?m=="smol.json"?await n.saveSmolAsJSON(_,{newFile:!0,force:c}):m=="sdf"?await n.saveSmolAsSDF(_,{newFile:!0,force:c}):m=="csv"?await n.saveSmolAsCSV(_,{newFile:!0,force:c}):m=="mol"?await n.saveSmolAsMDL(_,{newFile:!0,force:c}):m=="smi"&&await n.saveSmolAsSMILES(_,{newFile:!0,force:c}):["cif","pdb"].includes(d)&&(m=="mmol.json"?await n.saveMmolAsMmolJson(_,{newFile:!0,force:c}):m=="cif"?await n.saveMmolAsCIF(_,{newFile:!0,force:c}):m=="pdb"&&await n.saveMmolAsPDB(_,{newFile:!0,force:c}));const l=gt(_);h.push("/~/"+l)}catch(l){const r=(l==null?void 0:l.data)||"An error occurred while saving the file.",b=l==null?void 0:l.status;l!=null&&l.status||console.error(l),b==409?u.confirm(r,{title:"Overwrite existing file?",onSubmit:()=>s({destinationPath:_,ext:m,srcDataType:d},!0)}):u.alert(r,{title:"Error"})}}}const Rt=E({__name:"OverflowMenuMol",props:{dataType:{},disabled:{type:Boolean}},setup(h){const u=_e(),i=J(),o=R(),n=fe(),s=_t(),_=h,m=[{val:"save-as",disp:"Save as...",action:d}];i.active&&["smol","mmol","cif","pdb"].includes(i.fileType)&&m.push({val:"delete",disp:"Delete",action:c});function d(){if(console.log("dataType: ",_.dataType),_.dataType=="smol")return s("smol",!0,{defaultName:o.nameSlug});if(_.dataType=="cif")return s("cif",!0,{defaultName:o.nameSlug});if(_.dataType=="pdb")return s("pdb",!0,{defaultName:o.nameSlug});console.error(`actionSaveAs() -> props.dataType "${_.dataType}" not recognized`)}async function c(){n.confirm("This cannot be undone.",{title:"Please confirm deletion",primaryBtn:"Delete",onSubmit:async()=>{await i.deleteFile(i.pathAbsolute)&&u.push("/~/"+i.pathDir)}})}return(l,r)=>(e(),M(zt,{options:m,disabled:l.disabled},null,8,["disabled"]))}}),jt=H(Rt,[["__scopeId","data-v-67ccb099"]]),Pt=E({__name:"BaseIconButtonToggle",props:{icon:{},iconHover:{},iconOn:{},iconOnHover:{},color:{},colorHover:{},colorOn:{},colorOnHover:{},mini:{type:Boolean}},emits:["toggle-on","toggle-off"],setup(h,{expose:u,emit:i}){const o=i,n=h,s=P(!1),_=P(!1),m={soft:"rgba(0,0,0,.3)",semiSoft:"rgba(0,0,0,.6)",hard:"#393939"},d=k(()=>{const l={};return l["--btn-color"]=n.color?n.color:m.soft,l["--btn-color-hover"]=n.colorHover?n.colorHover:m.soft,l["--btn-color-on"]=n.colorOn?n.colorOn:m.hard,l["--btn-color-on-hover"]=n.colorOnHover?n.colorOnHover:m.hard,l});function c(l=void 0,r=!1){l!==void 0?s.value=l:s.value=!s.value,s.value?(_.value=!0,r||o("toggle-on")):r||o("toggle-off")}return u({toggle:c}),(l,r)=>(e(),t("div",{class:O(["icn-btn",{[n.icon]:!0,mini:n.mini,"toggle-on":s.value,"ignore-hover":_.value,"has-hover-icn":n.iconHover,"has-on-icn":n.iconOn,"has-on-hover-icn":n.iconOnHover,"has-custom-color":!!n.color,"has-custom-hover-color":!!n.colorHover,"has-custom-toggle-color":!!n.colorOn}]),onClick:r[0]||(r[0]=b=>c()),onMouseleave:r[1]||(r[1]=b=>_.value=!1),style:G(d.value)},[T(U,{class:"base-icn",icon:n.icon},null,8,["icon"]),n.iconHover?(e(),M(U,{key:0,class:"hover-icn",icon:n.iconHover},null,8,["icon"])):p("",!0),n.iconOn?(e(),M(U,{key:1,class:"on-icn",icon:n.iconOn},null,8,["icon"])):p("",!0),n.iconOnHover?(e(),M(U,{key:2,class:"on-hover-icn",icon:n.iconOnHover},null,8,["icon"])):p("",!0)],38))}}),Wt=H(Pt,[["__scopeId","data-v-f7770c45"]]),Ut=E({__name:"BaseBookmark",props:{mol:{}},setup(h){const u=h,i=P(null),o=P(!1),n=P("");ct(()=>u.mol,m),ut(m);async function s(){if(!u.mol){n.value="x";return}he(pe.addMolToMyMols(u.mol),{onError:()=>{i.value&&i.value.toggle(!1,!0)},loading:o,loadingError:n})}async function _(){if(!u.mol){n.value="x";return}he(pe.removeMolFromMyMols(u.mol),{onError:d=>{i.value&&i.value.toggle(d.status,!0)},loading:o,loadingError:n})}function m(){!u.mol||!("properties"in u.mol)||u.mol&&he(pe.checkMolInMyMols(u.mol),{onSuccess:d=>{i.value&&i.value.toggle(d.status,!0)}})}return(d,c)=>(e(),M(Wt,{ref_key:"toggleBtn",ref:i,class:O({loading:o.value,error:!!n.value}),icon:"icn-bookmark",iconHover:"icn-bookmark-full",iconOn:"icn-bookmark-full",iconOnHover:"icn-bookmark-remove",onToggleOn:s,onToggleOff:_},null,8,["class"]))}}),Kt=H(Ut,[["__scopeId","data-v-c39285cc"]]),Gt={class:"display"},Jt=["value"],qt={key:0,value:"before",disabled:""},Qt=["value"],Xt={key:1,value:"after",disabled:""},Yt=E({__name:"BasePagination",props:{total:{},modelValue:{default:1},disabled:{type:Boolean}},emits:["update:modelValue"],setup(h,{emit:u}){const i=u,o=h,n=k(()=>kt(o.total)),s=k(()=>{const l=[],r=Math.max(1,o.modelValue-100),b=Math.min(o.total,r+200);for(let w=r;w<=b;w++)l.push(w);return l});function _(){o.modelValue>1&&i("update:modelValue",o.modelValue-1)}function m(){o.modelValue<o.total&&i("update:modelValue",o.modelValue+1)}function d(c){c&&(c=typeof c=="string"?parseInt(c):c,i("update:modelValue",c))}return(c,l)=>(e(),t("div",{class:O(["pagination",{disabled:c.disabled}])},[a("div",{class:"btn",onClick:_},[T(U,{icon:"icn-caret-left"})]),a("div",{class:"btn",onClick:m},[T(U,{icon:"icn-caret-right"})]),a("div",Gt,[a("span",null,y(o.modelValue)+" / "+y(n.value),1),a("select",{value:o.modelValue,onChange:l[0]||(l[0]=r=>{var b;return d((b=r.target)==null?void 0:b.value)})},[s.value[0]>1?(e(),t("option",qt,"...")):p("",!0),(e(!0),t(C,null,F(s.value,r=>(e(),t("option",{key:r,value:r},y(r),9,Qt))),128)),s.value[s.value.length-1]<o.total?(e(),t("option",Xt,"...")):p("",!0)],40,Jt)])],2))}}),Zt=H(Yt,[["__scopeId","data-v-52b27309"]]),eo=h=>(ie("data-v-e90d8580"),h=h(),re(),h),to={id:"title-wrap"},oo={class:"v-align"},so=eo(()=>a("div",{class:"filler"},null,-1)),ao=E({__name:"MolViewerTitle",props:{context:{default:"file"},loading:{type:Boolean}},setup(h){const u=_e(),i=J(),o=R(),n=ce(),s=h,_=k(()=>s.loading?"Loading":o.name),m=k(()=>s.context=="molset"?"icn-file-molset":o.isSmol?"icn-file-smol":"icn-file-mmol"),d=k({get:()=>o.molFromMolsetIndex||1,set:o.setMolFromMolsetIndex});return(c,l)=>(e(),t("div",to,[a("div",oo,[T(U,{class:O(["icn-mol",{loading:c.loading}]),icon:m.value,size:"large"},null,8,["class","icon"])]),a("h2",{id:"data-name","data-val":"{{ molName }}",class:O({loading:c.loading})},y($(bt)(_.value)),3),so,$(o).smol?(e(),M(Kt,{key:0,mol:$(o).smol},null,8,["mol"])):p("",!0),T(jt,{dataType:$(o).dataType,disabled:!!c.loading},null,8,["dataType","disabled"]),c.context=="molset"?(e(),M(Zt,{key:1,modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=r=>d.value=r),total:$(n).total},null,8,["modelValue","total"])):p("",!0),c.context=="molset"?(e(),M(ne,{key:2,icon:"icn-close",icnSize:"small",btnStyle:"carbon",onClick:l[1]||(l[1]=r=>$(o).setMolFromMolsetIndex(null))})):(e(),M(ne,{key:3,icon:"icn-close",icnSize:"small",btnStyle:"default",onClick:l[2]||(l[2]=r=>c.context=="file"?$(i).exitViewer():c.context=="identifier"?$(u).push({name:"mol"}):null),style:{"margin-right":"-8px"}}))]))}}),lo=H(ao,[["__scopeId","data-v-e90d8580"]]),no=E({__name:"TheButtonSaveMol",setup(h){const u=R(),i=J(),o=ce(),n=_t(),s=P(!1),_=k(()=>i.active&&!["smol","molset"].includes(i.fileType||"")),m=k(()=>{if(o.active){if(o.context=="json"||o.context=="my-mols")return!1}else if(i.fileType=="smol")return!1;return!0}),d=k(()=>u.hasChanges);async function c(){let l=!1;s.value=!0,o.active?o.context=="json"?l=await o.replaceMolInMolset(i.path,u.smol,o.context):o.context=="my-mols"?l=await o.replaceMolInMolset(i.path,u.smol,o.context):(o.setHasChanges(!1),l=await n("smol",!0,{defaultName:u.nameSlug}),o.setHasChanges(!l)):!i.active||_.value?(u.setHasChanges(!1),l=await n("smol",!0,{defaultName:u.nameSlug}),u.setHasChanges(!l)):i.fileType=="smol"&&(l=await u.saveSmolAsJSON(i.path,{newFile:!1})),l&&(u.setHasChanges(!1),o.setHasChanges(!1)),s.value=!1}return(l,r)=>{const b=ve("cv-button");return d.value?(e(),M(b,{key:0,size:"small",kind:"primary",class:O(["btn-save",{saving:s.value,"save-as":m.value}]),disabled:s.value,onClick:c},null,8,["class","disabled"])):p("",!0)}}}),io=H(no,[["__scopeId","data-v-07df3337"]]),ro=E({__name:"TheButtonEnrichMol",setup(h){const u=R(),i=ce(),o=P(!1),n=k(()=>!u.enriched);async function s(){o.value=!0,await u.enrichSmol()&&u.molFromMolset&&i.setHasChanges(!0),o.value=!1}return(_,m)=>{const d=ve("cv-button");return n.value?(e(),M(d,{key:0,size:"small",kind:"secondary",class:O(["btn-enrich",{enriching:o.value}]),disabled:o.value,title:"Calculate molecular properties and load data from PubChem",onClick:s},null,8,["class","disabled"])):p("",!0)}}}),co=H(ro,[["__scopeId","data-v-7283d0a8"]]),K=h=>(ie("data-v-1fe8a102"),h=h(),re(),h),uo={id:"identification"},vo={key:0},_o=["data-copy"],mo={key:0,id:"data-inchi"},ho={key:1,class:"blank"},po={key:1},fo=["data-copy"],yo={key:0,id:"data-inchikey"},go={key:1,class:"blank"},ko={key:2},bo=["data-copy"],wo={id:"data-smiles"},$o={key:3},So=["data-copy"],Mo={key:0,id:"data-canonical-smiles"},Co={key:1,class:"blank"},Do={key:4},Bo=["data-copy"],Io={key:0,id:"data-isomeric-smiles"},Vo={key:1,class:"blank"},To={key:5},Ao=["data-copy"],Fo={key:0,id:"data-isomeric-smiles"},Eo={key:1,class:"blank"},Ho={key:6},Oo=["data-copy"],Lo=["href"],No={key:1,class:"blank"},xo=K(()=>a("hr",null,null,-1)),zo={key:1,id:"fetch-fail"},Ro=K(()=>a("div",{class:"error-msg"},"Something went wrong fetching the molecule data.",-1)),jo={key:0,class:"status-msg"},Po=K(()=>a("h3",null,"Synonyms",-1)),Wo={class:"flip-v"},Uo={key:1,class:"cloak"},Ko=["title"],Go=K(()=>a("hr",null,null,-1)),Jo={id:"properties"},qo=K(()=>a("h3",null,"Properties",-1)),Qo=["title"],Xo=["data-copy"],Yo=K(()=>a("div",{class:"filler"},null,-1)),Zo={class:"val"},es={key:0},ts={key:1,id:"analysis"},os=K(()=>a("h3",null,"Analysis",-1)),ss=["data-copy"],as=K(()=>a("br",null,null,-1)),ls=250,ns=150,is=E({__name:"MolViewerDataSmol",props:{loading:{type:Boolean},loadingError:{}},emits:["retryLoad"],setup(h,{emit:u}){const i=R(),o=dt(),n=u,s=k(()=>i.smol),_=k(()=>!!(i.smol&&"analysis"in i.smol&&i.smol.analysis.length)),m=k(()=>{var v;return"synonyms"in s.value&&(v=s.value)!=null&&v.synonyms?s.value.synonyms.length:0}),d=k(()=>`${Math.ceil(m.value/c.value)*22}px`),c=k(()=>o.contentWidth?Math.floor(o.contentWidth/ns)||1:4),l=k(()=>`calc((100% - ${(c.value-1)*20}px) / ${c.value})`),r=k(()=>{const v=5*c.value+c.value;return m.value>v}),b=k(()=>r.value?"110px":""),w=k(()=>o.contentWidth?Math.floor(o.contentWidth/ls)||1:3),z=k(()=>`calc((100% - ${(w.value-1)*40}px) / ${w.value})`),f=k(()=>{var I;if(!("properties"in s.value))return{};const v=(I=s.value)!=null&&I.properties?Object.keys(s.value.properties).length:0,A=Math.ceil(v/w.value)*22;return A?{height:`${A}px`}:{}});function S(v){v.currentTarget.classList.toggle("expand")}return(v,A)=>{var q,Q,X,Y,Z,ee,te,oe,se,ae,le,V,N,ge,ke,be,we,$e,Se,Me,Ce,De,Be,Ie,Ve,Te,Ae,Fe,Ee,He,Oe,Le,Ne,xe,ze,Re,je,Pe,We,Ue,Ke,Ge,Je,qe,Qe,Xe,Ye,Ze,et,tt,ot,st,at,lt,nt,it;const I=ve("cv-button"),B=ye("click-to-copy");return e(),t(C,null,[a("div",uo,[$(i).enriched||(Q=(q=s.value)==null?void 0:q.identifiers)!=null&&Q.inchi?(e(),t("div",vo,[D((e(),t("b",{"data-copy":`InChI: ${(Y=(X=s.value)==null?void 0:X.identifiers)==null?void 0:Y.inchi}`},[g("InChI: ")],8,_o)),[[B]]),(ee=(Z=s.value)==null?void 0:Z.identifiers)!=null&&ee.inchi?D((e(),t("span",mo,[g(y((oe=(te=s.value)==null?void 0:te.identifiers)==null?void 0:oe.inchi),1)])),[[B]]):(e(),t("span",ho,"-")),v.loading?(e(),M(j,{key:2,text:"",failText:"x",error:!!v.loadingError},null,8,["error"])):p("",!0)])):p("",!0),$(i).enriched||(ae=(se=s.value)==null?void 0:se.identifiers)!=null&&ae.inchikey?(e(),t("div",po,[D((e(),t("b",{"data-copy":`InChIKey: ${(V=(le=s.value)==null?void 0:le.identifiers)==null?void 0:V.inchikey}`},[g("InChIKey: ")],8,fo)),[[B]]),(ge=(N=s.value)==null?void 0:N.identifiers)!=null&&ge.inchikey?D((e(),t("span",yo,[g(y((be=(ke=s.value)==null?void 0:ke.identifiers)==null?void 0:be.inchikey),1)])),[[B]]):(e(),t("span",go,"-")),v.loading?(e(),M(j,{key:2,text:"",failText:"x",error:!!v.loadingError},null,8,["error"])):p("",!0)])):p("",!0),($e=(we=s.value)==null?void 0:we.identifiers)!=null&&$e.smiles&&(!((Me=(Se=s.value)==null?void 0:Se.identifiers)!=null&&Me.canonical_smiles)||(De=(Ce=s.value)==null?void 0:Ce.identifiers)!=null&&De.isomeric_smiles)?(e(),t("div",ko,[D((e(),t("b",{"data-copy":`SMILES: ${(Ie=(Be=s.value)==null?void 0:Be.identifiers)==null?void 0:Ie.smiles}`},[g("SMILES: ")],8,bo)),[[B]]),D((e(),t("span",wo,[g(y((Te=(Ve=s.value)==null?void 0:Ve.identifiers)==null?void 0:Te.smiles),1)])),[[B]]),v.loading?(e(),M(j,{key:0,text:"",failText:"x",error:!!v.loadingError},null,8,["error"])):p("",!0)])):p("",!0),$(i).enriched||(Fe=(Ae=s.value)==null?void 0:Ae.identifiers)!=null&&Fe.canonical_smiles?(e(),t("div",$o,[D((e(),t("b",{"data-copy":`Canonical SMILES: ${(He=(Ee=s.value)==null?void 0:Ee.identifiers)==null?void 0:He.canonical_smiles}`},[g("Canonical SMILES: ")],8,So)),[[B]]),(Le=(Oe=s.value)==null?void 0:Oe.identifiers)!=null&&Le.canonical_smiles?D((e(),t("span",Mo,[g(y((xe=(Ne=s.value)==null?void 0:Ne.identifiers)==null?void 0:xe.canonical_smiles),1)])),[[B]]):(e(),t("span",Co,"-")),v.loading?(e(),M(j,{key:2,text:"",failText:"x",error:!!v.loadingError},null,8,["error"])):p("",!0)])):p("",!0),$(i).enriched||(Re=(ze=s.value)==null?void 0:ze.identifiers)!=null&&Re.isomeric_smiles?(e(),t("div",Do,[D((e(),t("b",{"data-copy":`Isomeric SMILES: ${(Pe=(je=s.value)==null?void 0:je.identifiers)==null?void 0:Pe.isomeric_smiles}`},[g("Isomeric SMILES: ")],8,Bo)),[[B]]),(Ue=(We=s.value)==null?void 0:We.identifiers)!=null&&Ue.isomeric_smiles?D((e(),t("span",Io,[g(y((Ge=(Ke=s.value)==null?void 0:Ke.identifiers)==null?void 0:Ge.isomeric_smiles),1)])),[[B]]):(e(),t("span",Vo,"-")),v.loading?(e(),M(j,{key:2,text:"",failText:"x",error:!!v.loadingError},null,8,["error"])):p("",!0)])):p("",!0),$(i).enriched||(qe=(Je=s.value)==null?void 0:Je.identifiers)!=null&&qe.molecular_formula?(e(),t("div",To,[D((e(),t("b",{"data-copy":`Formula: ${(Xe=(Qe=s.value)==null?void 0:Qe.identifiers)==null?void 0:Xe.molecular_formula}`},[g("Formula: ")],8,Ao)),[[B]]),(Ze=(Ye=s.value)==null?void 0:Ye.identifiers)!=null&&Ze.molecular_formula?D((e(),t("span",Fo,[g(y((tt=(et=s.value)==null?void 0:et.identifiers)==null?void 0:tt.molecular_formula),1)])),[[B]]):(e(),t("span",Eo,"-")),v.loading?(e(),M(j,{key:2,text:"",failText:"x",error:!!v.loadingError},null,8,["error"])):p("",!0)])):p("",!0),$(i).enriched||(ot=s.value.identifiers)!=null&&ot.cid?(e(),t("div",Ho,[D((e(),t("b",{"data-copy":`PubChem CID: ${s.value.identifiers.cid}`},[g("PubChem CID: ")],8,Oo)),[[B]]),(at=(st=s.value)==null?void 0:st.identifiers)!=null&&at.cid?(e(),t("a",{key:0,id:"data-cid",href:`https://pubchem.ncbi.nlm.nih.gov/compound/${(lt=s.value.identifiers)==null?void 0:lt.cid}`,target:"_blank"},y(s.value.identifiers.cid),9,Lo)):(e(),t("span",No,"-")),v.loading?(e(),M(j,{key:2,text:"",failText:"x",error:!!v.loadingError},null,8,["error"])):p("",!0)])):p("",!0),!v.loading&&!v.loadingError?(e(),t(C,{key:7},[$(i).isSmol?(e(),M(co,{key:0})):p("",!0),T(io)],64)):p("",!0)]),xo,v.loading&&!v.loadingError?(e(),M(j,{key:0,text:"Fetching molecule data",error:!!v.loadingError},null,8,["error"])):v.loadingError?(e(),t("div",zo,[Ro,v.loadingError?(e(),t("div",jo,y(v.loadingError),1)):p("",!0),a("div",null,[T(I,{kind:"danger",size:"field",onClick:A[0]||(A[0]=L=>n("retryLoad"))},{default:ue(()=>[g("Retry")]),_:1})])])):(e(),t(C,{key:2},[a("div",{id:"synonyms",style:G({"--truncated-height":b.value})},[Po,a("div",Wo,[r.value?(e(),t("a",{key:0,href:"#",class:"toggle-expand",onClick:wt(S,["prevent"])})):p("",!0),m.value&&"synonyms"in s.value?(e(),t("div",Uo,[a("div",{class:"synonyms-wrap",style:G({height:d.value})},[(e(!0),t(C,null,F((nt=s.value)==null?void 0:nt.synonyms,(L,W)=>D((e(),t("div",{key:W,title:L,style:G({width:l.value})},[g(y(L),1)],12,Ko)),[[B]])),128))],4)])):v.loading?(e(),M(j,{key:2,error:!!v.loadingError},null,8,["error"])):(e(),t(C,{key:3},[g("No synonyms available")],64))])],4),Go,a("div",Jo,[qo,"properties"in s.value?(e(),t("div",{key:0,class:"param-wrap",style:G(f.value)},[(e(!0),t(C,null,F((it=s.value)==null?void 0:it.properties,(L,W)=>(e(),t("div",{key:W,title:$(i).propertiesString?$(i).propertiesString[W]:"",class:O({empty:!L&&L!==0}),style:G({width:z.value})},[D((e(),t("div",{"data-copy":`${W}: ${L}`,class:"key"},[g(y(W)+":",1)],8,Xo)),[[B]]),Yo,D((e(),t("div",Zo,[g(y(L||L===0?L:"-"),1)])),[[B]])],14,Qo))),128))],4)):p("",!0)]),_.value?(e(),t("hr",es)):p("",!0),_.value&&$(i).smol&&"analysis"in $(i).smol?(e(),t("div",ts,[os,(e(!0),t(C,null,F($(i).smol.analysis,(L,W)=>(e(),t("div",{key:W,class:"item"},[a("details",null,[a("summary",null,[a("b",null,y(L.toolkit),1),g(" / "+y(L.function),1)]),(e(!0),t(C,null,F(L.results,(mt,ht)=>(e(),t("div",{key:ht,class:"result"},[(e(!0),t(C,null,F(mt,(rt,me)=>(e(),t("div",{key:me},[D((e(),t("b",{"data-copy":`${me}: ${rt}`},[g(y(me)+":",1)],8,ss)),[[B]]),g(),D((e(),t("span",null,[g(y(rt),1)])),[[B]]),as]))),128))]))),128))])]))),128))])):p("",!0)],64))],64)}}}),rs=H(is,[["__scopeId","data-v-1fe8a102"]]),cs=["data-copy"],us={key:0},ds=["title"],vs=["href"],_s=["data-copy"],ms=E({__name:"TheTable",props:{data:{},inline:{type:Boolean,default:!1},header:{type:Boolean,default:!0},allowCopy:{type:Boolean,default:!1}},setup(h){const u=P(null),i=h,o=k(()=>{if(typeof i.data=="object"&&i.data!==null){let d=0,c=!0;for(const l in i.data){if(+l!==d){c=!1;break}d++}return c?"A":"B"}return null}),n=k(()=>m(i.data,o.value)),s=k(()=>{let d="",c=0;for(const l in n.value)(c>0||i.header)&&(d+=n.value[l].join(",")+`
`),c++;return d}),_=k(()=>{const d={header:[],body:[]};for(let c=0;c<n.value.length;c++){const l=n.value[c];Array.isArray(l)&&(c===0?l.forEach(r=>{d.header.push(r)}):d.body.push(l))}return d});function m(d,c){if(!d)return console.error("restructureData() - No data provided"),[];if(!c)return console.error("restructureData() - No data structure provided"),[];const l=[];if(c=="A"){let r=0;for(const b in d){const w=d[b];r===0&&(l[0]=[]),l[r+1]=[];for(const z in w)r===0&&l[r].push(z),l[r+1].push(w[z]);r++}}else if(c=="B"){let r=0;for(const b in d)r===0&&(l[0]=[]),l[r+1]=[b,d[b]],r++}return l}return(d,c)=>{const l=ye("click-to-copy");return e(),t("div",{ref_key:"overflowWrap",ref:u,class:O(["table-overflow-wrap",{inline:d.inline}])},[D((e(),t("table",{"data-copy":d.allowCopy?s.value:null,class:O({"key-val":o.value=="B"})},[d.header?(e(),t("thead",us,[a("tr",null,[(e(!0),t(C,null,F(_.value.header,(r,b)=>(e(),t("th",{key:b},[a("span",{class:O({soft:!r})},y(r||"-"),3)]))),128))])])):p("",!0),a("tbody",null,[(e(!0),t(C,null,F(_.value.body,(r,b)=>(e(),t("tr",{key:b},[(e(!0),t(C,null,F(r,(w,z)=>(e(),t("td",{key:z,title:o.value=="B"&&String(w).length>20?String(w):""},[w&&typeof w=="string"&&w.match(/^http(s)?:\/\//)?(e(),t("a",{key:0,href:w,target:"_blank"},y(w),9,vs)):D((e(),t("span",{key:1,"data-copy":z==0?`${w}: ${r[1]}`:z==1?w:null,class:O({soft:!w})},[g(y(w||"-"),1)],10,_s)),[[l,o.value=="B"]])],8,ds))),128))]))),128))])],10,cs)),[[l,d.allowCopy]])],2)}}}),de=H(ms,[["__scopeId","data-v-c01dd95c"]]),hs={key:0},ps={key:1},fs={class:"small soft"},ys={class:"small soft vector"},gs=E({__name:"MolViewerDataMmolMatrices",props:{data:{}},setup(h){const u=h,i=k(()=>{const o=u.data;return Array.isArray(o)?o:[o]});return(o,n)=>(e(!0),t(C,null,F(i.value,(s,_)=>(e(),t("div",{key:_,class:"matrix-wrap-wrap"},[(e(!0),t(C,null,F(s.matrices,(m,d)=>{var c;return e(),t("div",{key:d,class:"matrix-wrap"},[(c=s.fields)!=null&&c.id?(e(),t("h5",hs,"Matrix "+y(s.fields.id),1)):p("",!0),(e(!0),t(C,null,F(s.fields,(l,r)=>(e(),t("div",{key:r},[g(" • "),a("b",null,y(r)+":",1),g(" "+y(l),1)]))),128)),Object.keys(s.fields).length?(e(),t("br",ps)):p("",!0),a("div",fs,[g(" Matrix"),String(d)!="_"?(e(),t(C,{key:0},[g(" - "+y(d),1)],64)):p("",!0)]),T(de,{data:m,allowCopy:!0,header:!1},null,8,["data"]),a("div",ys,[g(" Vector"),String(d)!="_"?(e(),t(C,{key:0},[g(" - "+y(d),1)],64)):p("",!0)]),T(de,{data:[s.vectors[d]],allowCopy:!0,header:!1},null,8,["data"])])}),128))]))),128))}}),ks=H(gs,[["__scopeId","data-v-02f90a84"]]),x=h=>(ie("data-v-6acd705d"),h=h(),re(),h),bs=["innerHTML"],ws=x(()=>a("hr",null,null,-1)),$s={class:"data-block"},Ss=x(()=>a("h3",null,"Overview",-1)),Ms={class:"key-val"},Cs=["data-copy"],Ds=["href"],Bs={key:1},Is={class:"key-val"},Vs=["data-copy"],Ts=["href"],As={key:1},Fs={class:"key-val"},Es=x(()=>a("div",null,"FASTA",-1)),Hs=["href"],Os=["href"],Ls={key:1},Ns={class:"key-val"},xs=["data-copy"],zs={class:"key-val"},Rs=["data-copy"],js={class:"key-val inline"},Ps=["data-copy"],Ws={key:0},Us=["href"],Ks={key:0},Gs={key:1},Js={class:"key-val inline"},qs=["data-copy"],Qs={key:0},Xs=["href"],Ys={key:0},Zs={key:1},ea={key:0,class:"key-val"},ta=["data-copy"],oa=x(()=>a("hr",null,null,-1)),sa={class:"data-block"},aa=x(()=>a("h3",null,"Experimental Data Snapshot",-1)),la={class:"key-val"},na=x(()=>a("div",null,"Method",-1)),ia={class:"key-val"},ra=x(()=>a("div",null,"Resolution",-1)),ca={class:"key-val"},ua=x(()=>a("div",null,"R-Value Free",-1)),da={class:"key-val"},va=x(()=>a("div",null,"R-Value Work",-1)),_a={class:"key-val"},ma=x(()=>a("div",null,"R-Value Observed",-1)),ha=x(()=>a("hr",null,null,-1)),pa={key:0,class:"data-block"},fa=x(()=>a("h3",null,"Validation Report",-1)),ya=["src"],ga={key:1},ka={class:"data-block"},ba=x(()=>a("h3",null,"Meta Data",-1)),wa={key:0},$a=["href","name"],Sa={key:1},Ma={key:2},Ca=E({__name:"MolViewerDataMmol",setup(h){const u=R(),i=J(),o=k(()=>i.ext=="json"&&i.ext2=="mmol"),n=k(()=>u.mmolData),s=k(()=>u.mmolDataHuman),_=k(()=>{var f,S;return((S=(f=n.value)==null?void 0:f.entry)==null?void 0:S.id)||null}),m=k(()=>{var S;let f=(S=n.value)!=null&&S.database_2?s.value["Database 2"]:null;if(f){for(let v=0;v<f.length;v++)if(f[v]["Database ID"]=="Pdb")return f[v].Doi}return null}),d=k(()=>{var S,v;let f=((v=(S=n.value)==null?void 0:S.pdbx_database_status)==null?void 0:v.recvd_initial_deposition_date)||null;return f?new Date(f).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null}),c=k(()=>{var A;const f=((A=n.value)==null?void 0:A.pdbx_audit_revision_history)||null;if(!f)return null;const S=Array.isArray(f)?f:[f];let v=S?S[0].revision_date:null;return v?new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null}),l=k(()=>{var v;const f=(v=n.value)!=null&&v.audit_author?s.value["Audit Author"]:null;if(!f)return[];let S=Array.isArray(f)?f:[f];return S=S?S.map(A=>{let I=A.Name;return I=I.split(",").reverse(),I=I.map(B=>B.trim()),I[0].match(/^([a-zA-Z]\.)+$/)&&(I[0]=I[0].toUpperCase()),I=I.join(" "),I}):[],S}),r=k(()=>{var S,v;let f=(v=(S=n.value)==null?void 0:S.struct_keywords)!=null&&v.text?s.value["Structure Keywords"].Text:null;return f&&(f=f.split(","),f=f.map(A=>A.trim())),f}),b=k(()=>{if(!_.value)return null;const f=_.value.toLowerCase();return`https://files.rcsb.org/pub/pdb/validation_reports/${f.slice(1,3)}/${f}/${f}_multipercentile_validation.png`});ut(()=>{const f=window.location.hash;window.location.hash="",setTimeout(()=>{w(f)},1)});function w(f){if(!f)return;window.location.hash=f;const S=document.querySelector(`a[href="${f}"]`),v=S==null?void 0:S.closest("details");v&&v.setAttribute("open","true"),S==null||S.blur()}function z(f){return f?"https://scholar.google.com/scholar?q="+f.replace(/\s/g,"+"):""}return(f,S)=>{var A,I,B,q,Q,X,Y,Z,ee,te,oe,se,ae,le;const v=ye("click-to-copy");return e(),t(C,null,[a("div",{class:"capitalize",innerHTML:((I=(A=s.value)==null?void 0:A.Structure)==null?void 0:I.Title)||"<div class='soft'>No description available</div>"},null,8,bs),ws,a("div",$s,[Ss,a("div",Ms,[D((e(),t("div",{"data-copy":`PDB Entry: https://www.rcsb.org/structure/${_.value}`},[g("PDB Entry")],8,Cs)),[[v]]),_.value?(e(),t("a",{key:0,href:`https://www.rcsb.org/structure/${_.value}`,target:"_blank"},y(_.value),9,Ds)):(e(),t("div",Bs,"-"))]),a("div",Is,[D((e(),t("div",{"data-copy":`DOI Entry: https://doi.org/${m.value}`},[g("DOI")],8,Vs)),[[v]]),m.value?(e(),t("a",{key:0,href:`https://doi.org/${m.value}`,target:"_blank"},y(m.value),9,Ts)):(e(),t("div",As,"-"))]),a("div",Fs,[Es,_.value?(e(),t(C,{key:0},[a("a",{href:`https://www.rcsb.org/fasta/entry/${_.value}/display`,target:"_blank"},"View",8,Hs),g(" /  "),a("a",{href:`https://www.rcsb.org/fasta/entry/${_.value}`},"Download",8,Os)],64)):(e(),t("div",Ls,"-"))]),a("div",Ns,[D((e(),t("div",{"data-copy":`Deposited: ${d.value}`},[g("Deposited")],8,xs)),[[v]]),a("div",null,y(d.value||"-"),1)]),a("div",zs,[D((e(),t("div",{"data-copy":`Released: ${c.value}`},[g("Released")],8,Rs)),[[v]]),a("div",null,y(c.value||"-"),1)]),a("div",js,[D((e(),t("div",{"data-copy":`Authors: ${((B=l.value)==null?void 0:B.join(", "))||"-"}`},[g("Authors")],8,Ps)),[[v]]),l.value&&l.value.length?(e(),t("div",Ws,[(e(!0),t(C,null,F(l.value,(V,N)=>(e(),t(C,{key:N},[a("a",{href:z(V),target:"_blank",class:"lookup"},y(V),9,Us),l.value&&N<l.value.length-1?(e(),t("span",Ks,", ")):p("",!0)],64))),128))])):(e(),t("div",Gs,"-"))]),a("div",Js,[D((e(),t("div",{"data-copy":`Keywords: ${((q=r.value)==null?void 0:q.join(", "))||"-"}`},[g("Keywords")],8,qs)),[[v]]),r.value&&r.value.length?(e(),t("div",Qs,[(e(!0),t(C,null,F(r.value,(V,N)=>(e(),t(C,{key:N},[a("a",{href:z(V),target:"_blank",class:"lookup"},y(V),9,Xs),N<r.value.length-1?(e(),t("span",Ys,", ")):p("",!0)],64))),128))])):(e(),t("div",Zs,"-"))]),o.value?(e(),t("div",ea,[D((e(),t("div",{"data-copy":`PDB Entry: https://www.rcsb.org/structure/${_.value}`},[g("3D Data")],8,ta)),[[v]]),a("div",null,y($(u).mmolData3DFormat),1)])):p("",!0)]),oa,a("div",sa,[aa,a("div",la,[na,a("div",null,y(((X=(Q=s.value)==null?void 0:Q.Experimental)==null?void 0:X.Method)||"-"),1)]),a("div",ia,[ra,a("div",null,y(((Z=(Y=n.value)==null?void 0:Y.reflns_shell)==null?void 0:Z.d_res_high)||"-"),1)]),a("div",ca,[ua,a("div",null,y(((te=(ee=n.value)==null?void 0:ee.refine)==null?void 0:te.ls_R_factor_R_free)||"-"),1)]),a("div",da,[va,a("div",null,y(((se=(oe=n.value)==null?void 0:oe.refine)==null?void 0:se.ls_R_factor_R_work)||"-"),1)]),a("div",_a,[ma,a("div",null,y(((le=(ae=n.value)==null?void 0:ae.refine)==null?void 0:le.ls_R_factor_obs)||"-"),1)])]),ha,b.value?(e(),t("div",pa,[fa,a("img",{id:"validation-report",src:b.value,alt:"Validation report"},null,8,ya)])):p("",!0),b.value?(e(),t("hr",ga)):p("",!0),a("div",ka,[ba,(e(!0),t(C,null,F(s.value,(V,N)=>(e(),t(C,{key:N},[Object.keys(V).length?(e(),t("details",wa,[a("summary",null,[a("h4",null,[g(y(N),1),a("a",{href:"#"+$(u).mmolDataKeyMap[N],name:$(u).mmolDataKeyMap[N]},"#",8,$a)])]),a("div",null,[V.matrices&&V.vectors||Array.isArray(V)&&V[0].matrices&&V[0].vectors?(e(),M(ks,{key:0,data:V},null,8,["data"])):Array.isArray(V)?(e(),t("div",Sa,[T(de,{data:V,allowCopy:!0},null,8,["data"])])):(e(),t("div",Ma,[T(de,{data:V,allowCopy:!1},null,8,["data"])]))])])):p("",!0)],64))),128))])],64)}}}),Da=H(Ca,[["__scopeId","data-v-6acd705d"]]);const Ba={id:"content-wrap"},Ia={class:"col-left"};const Va=E({__name:"MolViewer",props:{context:{default:"file"},loading:{type:Boolean},loadingError:{}},emits:["retryLoad"],setup(h){const u=_e(),i=dt(),o=R(),n=J(),s=ce(),_=fe(),m=h,d=k(()=>o.molType),c=k(()=>{var r;return m.context=="molset"?n.breadCrumbPathArray.concat(["mol #"+((r=o.molFromMolsetIndex)==null?void 0:r.toString())]):n.breadCrumbPathArray});if(o.isEmpty&&n.data&&n.moduleName=="MolViewer"){const r=n.data;o.setMolData(r,"smol")}(m.context=="file"||m.context=="identifier")&&(o.inchi?o.fetchSmolVizData(o.inchi):o.smiles&&o.fetchSmolVizData(o.smiles)),$t(o.clear),window.onbeforeunload=function(){if(s.hasChanges)return!0;s.clear()},St(l),Mt(l);async function l(r,b,w){o.molFromMolset?w():o.hasChanges?await _.alert("If you leave, all changes to this molecule will be lost.",{title:"Unsaved molecule changes",primaryBtn:"Stay",secondaryBtn:"Discard",onCancel:()=>{r.fullPath!=b.fullPath&&o.clear(),w()},onSubmit:()=>w(!1)}):(r.path!=b.path&&o.clear(),w())}return(r,b)=>(e(),t(C,null,[a("div",{id:"mol-render",class:O({headless:$(i).headless})},[d.value=="smol"?(e(),M(Ft,{key:0})):d.value=="mmol"?(e(),M(Ht,{key:1})):p("",!0)],2),a("div",Ba,[a("div",Ia,[r.context=="identifier"?(e(),M(Vt,{key:0,backto:{name:"mol"}},{default:ue(()=>[T(ne,{icon:"icn-file-json",iconHover:"icn-file-json-hover",btnStyle:"soft",mini:"",onClick:b[0]||(b[0]=w=>$(u).push("?use=json"))})]),_:1})):(e(),M(Ct,{key:1,pathArray:c.value},{default:ue(()=>[T(ne,{icon:"icn-file-json",iconHover:"icn-file-json-hover",btnStyle:"soft",mini:"",onClick:b[1]||(b[1]=w=>$(u).push("?use=json"))})]),_:1},8,["pathArray"])),T(lo,{context:r.context,loading:r.loading},null,8,["context","loading"]),d.value=="smol"?(e(),M(rs,{key:2,loading:r.loading,loadingError:r.loadingError,onRetryLoad:b[2]||(b[2]=w=>r.$emit("retryLoad"))},null,8,["loading","loadingError"])):d.value=="mmol"?(e(),M(Da,{key:3})):p("",!0)]),(r.loading,p("",!0))])],64))}}),Ta=H(Va,[["__scopeId","data-v-b7a671e5"]]),La=Object.freeze(Object.defineProperty({__proto__:null,default:Ta},Symbol.toStringTag,{value:"Module"}));export{Zt as B,Ta as M,Kt as a,Vt as b,La as c,_t as u};
